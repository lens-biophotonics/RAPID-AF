<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rapid-af: rapid-af</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rapid-af
   </div>
   <div id="projectbrief">Real-time image-based autofocus for all wide-field optical microscopy systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">rapid-af </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p>Real-time image-based autofocus for all wide-field optical microscopy systems</p>
<p></p>
</blockquote>
<p>RAPID (Rapid Autofocusing via Pupil-split Image phase Detection) is an implementation of the phase detection principle for defocus measurement, applicable to all wide-field optical microscopes including light-sheet ones. In RAPID, two images of the same field of view are formed selecting the rays passing through two distinct portions of the system pupil. The mutual displacement between these images (the 'phase') is linearly proportional to the defocus.</p>
<p>The details of the optical setup can be found in <a href="https://www.biorxiv.org/content/10.1101/170555v1">https://www.biorxiv.org/content/10.1101/170555v1</a>. The code reported here, exploiting OpenCV, can be used to implement efficient image registration between the two pupil-split images.</p>
<h1>What this code does</h1>
<p>It performs optional image pre-processing, and computes cross-correlation to find mutual image displacement. This is the most general part of the RAPID concept, which is independent from the actual optical implementation.</p>
<h1>What this code does NOT</h1>
<p>It does not include packages for image grabbing (or camera management in general). Also, no code for actual defocus correction (e.g. by moving the detection objective) is provided. These modules depend on the hardware used in the microscope.</p>
<h1>How to build this project</h1>
<p>On Ubuntu, install the following packages: </p><div class="fragment"><div class="line">sudo apt install cmake build-essential libopencv-dev</div>
</div><!-- fragment --><p>Create a build directory outside the current repository, then run cmake: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line"> </div>
<div class="line">cmake /path/to/rapid/repository</div>
<div class="line">make</div>
<div class="line">sudo make install</div>
</div><!-- fragment --><p>This will install a binary named <code>rapid-af</code> and a library named <code>librapid-af.so</code>.</p>
<h1>How to use rapid-af</h1>
<p>In your <code>CMakeLists.txt</code>, add the following: </p><div class="fragment"><div class="line">find_package(rapid-af REQUIRED)</div>
</div><!-- fragment --><p>Then, when linking libraries to your executable: </p><div class="fragment"><div class="line">add_executable(myexecutable main.cpp)</div>
<div class="line">target_link_libraries(myexecutable</div>
<div class="line">    rapid-af</div>
<div class="line">)</div>
</div><!-- fragment --><p>In your source file: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rapid-af_8h.html">rapid-af.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> main() {</div>
<div class="line">    cv::Mat i1, i2;</div>
<div class="line">    <span class="keywordtype">bool</span> ok;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span>rapid_af::Options opt;</div>
<div class="line">    cv::Point2f shift = <a class="code" href="namespacerapid__af.html#a0196d8e99362cd6fcc685eca505f0137">rapid_af::align</a>(i1, i2, opt, &amp;ok);</div>
<div class="line">}</div>
</div><!-- fragment --><h1>Documentation</h1>
<p><a href="https://lens-biophotonics.github.io/RAPID-AF">https://lens-biophotonics.github.io/RAPID-AF</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="arapid-af_8h_html"><div class="ttname"><a href="rapid-af_8h.html">rapid-af.h</a></div></div>
<div class="ttc" id="anamespacerapid__af_html_a0196d8e99362cd6fcc685eca505f0137"><div class="ttname"><a href="namespacerapid__af.html#a0196d8e99362cd6fcc685eca505f0137">rapid_af::align</a></div><div class="ttdeci">Point2f align(const Mat &amp;image1, const Mat &amp;image2, const struct AlignOptions opt, bool *const ok)</div><div class="ttdoc">Find the mutual displacement between two images.</div><div class="ttdef"><b>Definition:</b> rapid-af.cpp:228</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
